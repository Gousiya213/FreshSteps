<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Safe Routes ‚Äî FreshSteps AI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <style>body{background:#f5f7fa;font-family:Inter,Arial}.map{height:600px;border-radius:12px;margin-top:20px}</style>
</head>
<body>
  <div class="container py-4">
    <h2>üõ£Ô∏è Safest Routes</h2>
    <p><strong>From:</strong> {{ result.from_location or '‚Äî' }} &nbsp; ‚Üí &nbsp; <strong>To:</strong> {{ result.to_location or '‚Äî' }}</p>

    <div id="routeMap" class="map"></div>

    <a class="btn btn-secondary mt-3" href="{{ url_for('dashboard', submission_id=submission_id) }}">‚Üê Back to Dashboard</a>
  </div>

<script>
  // center map between two points if provided
  const fromLat = parseFloat("{{ result.latitude or 28.4595 }}") || 28.4595;
  const fromLon = parseFloat("{{ result.longitude or 77.0266 }}") || 77.0266;
  const toLat = fromLat + 0.02;
  const toLon = fromLon + 0.03;

  const map = L.map('routeMap').setView([(fromLat+toLat)/2, (fromLon+toLon)/2], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OpenStreetMap'}).addTo(map);

  // three deterministic mock routes (simple polylines)
  const route1 = [[fromLat,fromLon], [fromLat+0.008, fromLon+0.01], [toLat,toLon]]; // safe (green)
  const route2 = [[fromLat,fromLon], [fromLat+0.012, fromLon+0.015], [toLat,toLon]]; // alt (orange)
  const route3 = [[fromLat,fromLon], [fromLat+0.02, fromLon+0.02], [toLat,toLon]]; // polluted (red)

  L.polyline(route1, {color:'#16a34a', weight:6}).addTo(map).bindPopup("Safe Route (lower exposure)");
  L.polyline(route2, {color:'#f59e0b', weight:6}).addTo(map).bindPopup("Alternate Route");
  L.polyline(route3, {color:'#dc2626', weight:6}).addTo(map).bindPopup("Fast but polluted");

  L.marker(route1[0]).addTo(map).bindPopup("Start");
  L.marker(route1[route1.length-1]).addTo(map).bindPopup("Destination");
  map.fitBounds([route1,route2,route3]);
</script>
</body>
</html>
